<!DOCTYPE html>
{% load staticfiles %}

<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>CafeYaab</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    {#    <link rel="stylesheet" href="http://cdn.rawgit.com/morteza/bootstrap-rtl/v3.3.4/dist/css/bootstrap-rtl.min.css">#}
    <link rel="stylesheet" href="{% static "style.css" %}">
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css"
          media="all"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
    <script src="{% static "script/jquery-ui.min.js" %}" type="text/javascript"></script>

    {#    <script src="{% static "script/owl.carousel.js" %}"></script>#}
    {#    <link href="{% static "owl.carousel.css" %}">#}
    {#    <link href="{% static "owl.theme.default.css" %}" >#}
</head>
<body>
<nav class="navbar navbar-default" style="line-height: 50px;">
    <ul>
        <li class="nav navbar-nav"><a href="/home"> Home</a></li>
        <li class="nav navbar-nav"><a href="/cafes"> Cafes</a></li>
        <li id="search" style="display: none;">
            <form method="GET" action="/cafes/" class="ui-widget" id="searchForm">
                <div class="ui-widget">
                    <input name="query" class="searchInput form-control" type="text"
                           style="display: inline-block">
                    <input style="float: left; display: none;" class="btn btn-success" type="submit">
                </div>
            </form>
        </li>
        {% if user.is_authenticated %}
            <li class="pull-right"><a href="/logout">Logout</a></li>
            <li class="pull-right"><a href="/profile">Profile</a></li>
        {% else %}
            <li class="pull-right"><a href="/login">Login</a></li>
            <li class="pull-right"><a href="/signup">Signup</a></li>
        {% endif %}

    </ul>
</nav>

<div class="container">
    {% block content %}
    {% endblock %}
</div>


<script type="text/javascript">
    var search = document.getElementById('search');
    if (window.location.toString().split('/')[3] == 'cafes') {
        search.style.display = "inline-block";


    }
    $(function () {
        // Add refresh button after field (this can be done in the template as well)
        $('img.captcha').after(
            $('<a href="#void" class="captcha-refresh"><button class="btn btn-warning">Refresh</button></a>')
        );

        // Click-handler for the refresh-link
        $('.captcha-refresh').click(function () {
            var $form = $(this).parents('form');
            var url = location.protocol + "//" + window.location.hostname + ":"
                + location.port + "/captcha/refresh/";

            // Make the AJAX-call
            $.getJSON(url, {}, function (json) {
                $form.find('input[name="captcha_0"]').val(json.key);
                $form.find('img.captcha').attr('src', json.image_url);
            });

            return false;
        });
        $("input").addClass("form-control");
        $("small").addClass("form-text text-muted");
        $("#id_captcha_1").css("display", "inline-block");
    });


    $("img.captcha").css("margin-right", "20px").css("display", "inline-block");
    $(".searchInput").autocomplete({
        source: "/cafes/get_cafes/",
        minLength: 2,
        select: function (event, ui) {
            $(".searchInput").val(ui.item.value);
            $("#searchForm").submit();
        }
    })
</script>
</body>
</html>
